# 探索模块验收测试清单

测试时间：2026-01-10
应用版本：Earthlord - 探索模块完整版

---

## ✅ 测试清单

### 1. 资源 Tab 能正常显示
- [ ] **测试步骤**：
  1. 启动应用
  2. 点击底部 TabBar 的"资源" Tab（shippingbox.fill 图标）

- [ ] **预期结果**：
  - 进入 ResourcesTabView
  - 顶部显示"资源"标题
  - 显示交易功能开关
  - 显示 5 个分段选择器：POI、背包、已购、领地、交易

- [ ] **验证状态**：⬜ 通过 / ⬜ 失败

---

### 2. 分段切换正常工作
- [ ] **测试步骤**：
  1. 在资源页面，依次点击各个分段
  2. 测试 5 个分段：POI、背包、已购、领地、交易

- [ ] **预期结果**：
  - POI 分段：显示 POIListView（POI 列表页）
  - 背包分段：显示 BackpackView（背包页）
  - 已购分段：显示占位文字"已购功能开发中，敬请期待"
  - 领地分段：显示占位文字"领地功能开发中，敬请期待"
  - 交易分段：显示占位文字"交易功能开发中，敬请期待"
  - 切换流畅无卡顿

- [ ] **验证状态**：⬜ 通过 / ⬜ 失败

---

### 3. POI 列表显示 5 个假的 POI
- [ ] **测试步骤**：
  1. 进入资源 Tab
  2. 选择 POI 分段（默认已选中）
  3. 查看 POI 列表

- [ ] **预期结果**：
  - 显示 5 个 POI 卡片：
    1. **废弃超市**（绿色，超市类型，已发现，有物资）
    2. **医院废墟**（红色，医院类型，已搜空）
    3. **郊外加油站**（橙色，加油站类型，未发现，有物资）
    4. **药店废墟**（紫色，药店类型，已发现，有物资）
    5. **工厂废墟**（灰色，工厂类型，未发现，有物资）
  - 每个卡片显示：图标、名称、类型、状态标签、物资标签
  - 列表项带淡入动画（依次出现，间隔 0.1 秒）

- [ ] **验证状态**：⬜ 通过 / ⬜ 失败

---

### 4. POI 筛选功能正常
- [ ] **测试步骤**：
  1. 在 POI 列表页，查看筛选工具栏
  2. 点击"医院"筛选按钮
  3. 观察列表变化
  4. 点击"超市"筛选按钮
  5. 点击"全部"按钮

- [ ] **预期结果**：
  - 筛选工具栏显示：全部、医院、超市、工厂、药店、加油站
  - 点击"医院"：只显示"医院废墟"
  - 点击"超市"：只显示"废弃超市"
  - 点击"全部"：显示所有 5 个 POI
  - 选中的筛选按钮高亮显示（对应颜色背景）
  - 切换分类时列表重新播放淡入动画

- [ ] **验证状态**：⬜ 通过 / ⬜ 失败

---

### 5. 点击 POI 能跳转到详情页
- [ ] **测试步骤**：
  1. 在 POI 列表页，点击"废弃超市"卡片
  2. 观察页面跳转
  3. 点击左上角返回按钮
  4. 再次尝试点击其他 POI（如"医院废墟"）

- [ ] **预期结果**：
  - 点击后跳转到 POIDetailView（POI 详情页）
  - 跳转动画流畅（标准 NavigationLink 推入动画）
  - 顶部显示返回按钮（< 资源）
  - 点击返回可回到 POI 列表
  - 所有 POI 都可以正常点击跳转

- [ ] **验证状态**：⬜ 通过 / ⬜ 失败

---

### 6. 详情页显示正确的 POI 信息
- [ ] **测试步骤**：
  1. 点击进入"废弃超市"详情页
  2. 仔细检查所有显示内容

- [ ] **预期结果**：
  - **顶部渐变区域**（占屏幕 1/3）：
    - 绿色渐变背景（对应超市类型）
    - 大购物车图标（80pt，cart.fill）
    - 底部半透明遮罩显示"废弃超市"和"超市"

  - **描述卡片**：
    - 显示 POI 的描述文字

  - **信息区域**（5 项）：
    - 距离：350m
    - 物资状态：有物资（带箱子图标，橙色）
    - 危险等级：低危（蓝色）
    - 发现状态：已发现（蓝色眼睛图标）
    - 来源：地图数据

  - **操作按钮**：
    - 主按钮："搜寻此POI"（橙色渐变，可点击）
    - 次要按钮："标记已发现"、"标记无物资"（灰色边框）

- [ ] **验证状态**：⬜ 通过 / ⬜ 失败

---

### 7. 点击搜寻能弹出结果页
- [ ] **测试步骤**：
  1. 在"废弃超市"详情页，点击"搜寻此POI"按钮
  2. 观察弹窗出现
  3. 控制台查看调试输出

- [ ] **预期结果**：
  - 从底部弹出 ExplorationResultView（sheet 弹窗）
  - 弹窗有半透明背景遮罩
  - 可下拉关闭（iOS 标准 sheet 行为）
  - 控制台输出："🔍 开始搜寻 POI: 废弃超市"

- [ ] **验证状态**：⬜ 通过 / ⬜ 失败

---

### 8. 结果页显示统计和奖励
- [ ] **测试步骤**：
  1. 在探索结果弹窗中，仔细查看所有内容
  2. 观察动画效果

- [ ] **预期结果**：

  - **成就标题区域**：
    - 光圈动画效果
    - 大地图图标（橙色渐变圆形背景）
    - "探索完成！"标题
    - "成功探索新区域"副标题

  - **统计数据卡片**（带数字跳动动画）：
    - **行走距离**：
      - 本次：2.5 km
      - 累计：15 km
      - 排名：#42（绿色徽章）
    - **探索面积**：
      - 本次：50000 m²
      - 累计：250000 m²
      - 排名：#38（绿色徽章）
    - **探索时长**：30分0秒

  - **奖励物品卡片**：
    - 标题："获得物品"（礼物图标）
    - 物品依次出现（每个间隔 0.2 秒）：
      1. 木材 x5（灰色立方体图标，绿色对勾）
      2. 矿泉水 x3（蓝色水滴图标，绿色对勾）
      3. 罐头食品 x2（棕色餐具图标，绿色对勾）
    - 底部提示："已添加到背包"（绿色背景）

  - **确认按钮**：
    - 橙色渐变大按钮："确认"

- [ ] **验证状态**：⬜ 通过 / ⬜ 失败

---

### 9. 背包页显示物品列表
- [ ] **测试步骤**：
  1. 返回资源 Tab
  2. 切换到"背包"分段
  3. 查看背包内容

- [ ] **预期结果**：

  - **容量状态卡**：
    - 显示"64/100 kg"
    - 进度条显示 64%（橙色，因为超过 60%）
    - 进度条有填充动画（从 0 到 64%）

  - **搜索框**：
    - 占位符："搜索物品名称..."
    - 带放大镜图标

  - **分类筛选工具栏**：
    - 全部、食物、水、医疗、材料、工具

  - **物品列表**（8 个物品）：
    1. 矿泉水 x3（水分类，蓝色，3kg）
    2. 罐头食品 x5（食物分类，棕色，5kg）
    3. 绷带 x8（医疗分类，红色，0.8kg，良好品质徽章）
    4. 抗生素药品 x2（医疗分类，红色，0.2kg，普通品质徽章）
    5. 木材 x12（材料分类，灰色，12kg）
    6. 废金属 x7（材料分类，灰色，14kg）
    7. 手电筒 x1（工具分类，紫色，0.5kg，优秀品质徽章）
    8. 尼龙绳 x2（工具分类，紫色，1kg，良好品质徽章）

  - 每个物品卡片显示：图标、名称、数量、重量、品质徽章、使用/存储按钮

- [ ] **验证状态**：⬜ 通过 / ⬜ 失败

---

### 10. 背包筛选和搜索正常
- [ ] **测试步骤**：

  **测试筛选**：
  1. 点击"食物"分类按钮
  2. 观察列表变化
  3. 点击"水"分类
  4. 点击"全部"

  **测试搜索**：
  1. 在搜索框输入"水"
  2. 观察列表变化
  3. 清空搜索框
  4. 输入"绳"

- [ ] **预期结果**：

  **筛选功能**：
  - 点击"食物"：只显示"罐头食品"
  - 点击"水"：只显示"矿泉水"
  - 点击"全部"：显示所有 8 个物品
  - 选中的分类按钮高亮显示
  - 切换分类时列表有过渡动画（淡入淡出）

  **搜索功能**：
  - 输入"水"：只显示"矿泉水"
  - 清空：显示所有物品
  - 输入"绳"：只显示"尼龙绳"
  - 搜索不区分大小写
  - 实时过滤（输入时立即响应）

- [ ] **验证状态**：⬜ 通过 / ⬜ 失败

---

### 11. 地图页面显示三个按钮（圈地、定位、探索）
- [ ] **测试步骤**：
  1. 切换到"地图" Tab
  2. 查看底部按钮布局

- [ ] **预期结果**：
  - 底部显示 3 个按钮，水平排列（从左到右）：
    1. **开始圈地**（flag.fill 图标，橙色胶囊按钮）
    2. **定位**（location.fill 图标，橙色圆形按钮）
    3. **探索**（binoculars.fill 图标，橙色胶囊按钮）
  - 三个按钮间距均匀（spacing: 12）
  - 所有按钮都有阴影效果
  - 按钮样式一致（主题色、圆角、阴影）

- [ ] **验证状态**：⬜ 通过 / ⬜ 失败

---

### 12. 探索完成后弹出结果页面
- [ ] **测试步骤**：
  1. 在地图页面，点击"探索"按钮
  2. 观察按钮状态变化
  3. 等待 1.5 秒
  4. 观察结果弹窗
  5. 点击"确认"按钮关闭弹窗

- [ ] **预期结果**：

  **点击探索按钮后**：
  - 按钮立即变为灰色
  - 图标变为转圈的 ProgressView
  - 文字变为"探索中..."
  - 按钮不可点击（disabled）

  **1.5 秒后**：
  - 按钮恢复正常状态（橙色，"探索"文字）
  - 从底部弹出 ExplorationResultView

  **结果弹窗内容**：
  - 显示与步骤 8 相同的探索结果内容
  - 统计数据、排名、获得物品等
  - 所有动画正常播放

  **点击确认后**：
  - 弹窗关闭（下滑消失）
  - 返回地图页面
  - 探索按钮可再次点击

- [ ] **验证状态**：⬜ 通过 / ⬜ 失败

---

## 🎯 附加测试项

### 空状态测试

#### POI 列表空状态
- [ ] **测试步骤**：
  1. 在 POI 列表页，选择某个没有数据的分类（如果有的话）

- [ ] **预期结果**：
  - 显示空状态图标和文字
  - "没有找到该类型的地点"
  - "尝试切换其他分类或清除筛选条件"

#### 背包空状态
- [ ] **测试步骤**：
  1. 在背包页，输入不存在的物品名（如"ZZZZZ"）

- [ ] **预期结果**：
  - 显示空状态
  - "未找到匹配的物品"
  - "尝试使用其他关键词搜索"

---

### 动画测试

- [ ] **POI 列表动画**：
  - 列表项依次淡入（间隔 0.1 秒）
  - 搜索按钮按下时缩放到 0.95

- [ ] **背包动画**：
  - 容量进度条从 0 填充到当前值
  - 切换分类时列表过渡动画

- [ ] **探索结果动画**：
  - 统计数字从 0 跳动到目标值
  - 奖励物品依次出现（间隔 0.2 秒）
  - 对勾图标弹跳动画

---

### 交互测试

- [ ] **搜索 POI 按钮**：
  - 点击后显示"搜索中..."和 ProgressView
  - 1.5 秒后恢复正常
  - 控制台输出"✅ 搜索完成"

- [ ] **交易开关**：
  - 打开后变为绿色
  - 关闭后变为灰色
  - 左侧图标颜色同步变化

- [ ] **已搜空的 POI**：
  - 点击"医院废墟"
  - 主按钮显示"已搜空"（灰色，禁用）
  - 无法点击

---

## 📊 测试结果汇总

### 通过情况
- ⬜ 全部通过（12/12 核心功能 + 附加测试）
- ⬜ 部分通过（请在下方记录失败项）
- ⬜ 未通过（需要修复）

### 失败项记录
```
功能编号 | 失败原因 | 截图/日志
--------|---------|----------
        |         |
        |         |
        |         |
```

### 测试环境
- 设备：iPhone 17 Pro Simulator
- iOS 版本：26.1
- Xcode 版本：16.x
- 测试日期：2026-01-10

---

## ✨ 代码实现确认

以下功能已在代码层面完整实现：

✅ ExplorationModels.swift - 数据模型定义
✅ MockExplorationData.swift - 测试假数据
✅ POIListView.swift - POI 列表页
✅ POIDetailView.swift - POI 详情页
✅ ExplorationResultView.swift - 探索结果页
✅ BackpackView.swift - 背包页
✅ ResourcesTabView.swift - 资源模块入口
✅ MapTabView.swift - 地图页探索按钮
✅ 完整的导航流程（NavigationLink + Sheet）
✅ 所有交互动画
✅ 空状态和错误状态

---

## 📝 备注

- 所有假数据定义在 `MockExplorationData.swift`
- 导航测试指南见 `NAVIGATION_TEST_GUIDE.md`
- 构建状态：✅ BUILD SUCCEEDED
- SourceKit 警告（ApocalypseTheme）不影响运行

测试完成后，请在每个复选框 `[ ]` 中填入 `x` 标记为已测试，并记录测试结果。
