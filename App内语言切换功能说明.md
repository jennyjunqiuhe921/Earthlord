# App å†…è¯­è¨€åˆ‡æ¢åŠŸèƒ½ä½¿ç”¨è¯´æ˜

## âœ… åŠŸèƒ½å®ç°å®Œæˆ

å·²æˆåŠŸä¸º Earthlord æ·»åŠ  App å†…è¯­è¨€åˆ‡æ¢åŠŸèƒ½ï¼Œæ— éœ€ä¾èµ–ç³»ç»Ÿè¯­è¨€è®¾ç½®ï¼

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

### 1. ä¸‰ç§è¯­è¨€é€‰é¡¹
- âœ… **è·Ÿéšç³»ç»Ÿ** - è‡ªåŠ¨ä½¿ç”¨è®¾å¤‡ç³»ç»Ÿè¯­è¨€
- âœ… **ç®€ä½“ä¸­æ–‡** - å¼ºåˆ¶ä½¿ç”¨ç®€ä½“ä¸­æ–‡
- âœ… **English** - å¼ºåˆ¶ä½¿ç”¨è‹±æ–‡

### 2. æ ¸å¿ƒç‰¹æ€§
- âœ… **ç«‹å³ç”Ÿæ•ˆ** - åˆ‡æ¢è¯­è¨€åç«‹å³åˆ·æ–°ç•Œé¢ï¼Œæ— éœ€é‡å¯ App
- âœ… **æŒä¹…åŒ–å­˜å‚¨** - ç”¨æˆ·é€‰æ‹©ä¿å­˜åœ¨ UserDefaultsï¼Œä¸‹æ¬¡æ‰“å¼€ä¿æŒé€‰æ‹©
- âœ… **ç‹¬ç«‹äºç³»ç»Ÿ** - App è¯­è¨€è®¾ç½®ä¸å½±å“ç³»ç»Ÿè¯­è¨€ï¼Œåä¹‹äº¦ç„¶
- âœ… **å®Œæ•´æœ¬åœ°åŒ–** - æ”¯æŒ 56 ä¸ªæœ¬åœ°åŒ–å­—ç¬¦ä¸²

## ğŸ“± ä½¿ç”¨æ–¹æ³•

### ç”¨æˆ·æ“ä½œæµç¨‹

1. **è¿›å…¥è®¾ç½®é¡µé¢**
   - æ‰“å¼€ App
   - ç‚¹å‡»åº•éƒ¨å¯¼èˆªæ çš„"ä¸ªäºº"æ ‡ç­¾
   - åœ¨ä¸ªäººé¡µé¢ç‚¹å‡»"è®¾ç½®"èœå•é¡¹

2. **åˆ‡æ¢è¯­è¨€**
   - åœ¨è®¾ç½®é¡µé¢æ‰¾åˆ°"è¯­è¨€è®¾ç½®"åŒºå—
   - é€‰æ‹©æƒ³è¦çš„è¯­è¨€é€‰é¡¹ï¼š
     - ğŸ”§ è·Ÿéšç³»ç»Ÿ / Follow System
     - ğŸ“ ç®€ä½“ä¸­æ–‡
     - ğŸ”¤ English
   - ç‚¹å‡»åç«‹å³ç”Ÿæ•ˆ

3. **ç•Œé¢åˆ·æ–°**
   - é€‰æ‹©è¯­è¨€åï¼Œæ‰€æœ‰ç•Œé¢æ–‡æœ¬ç«‹å³æ›´æ–°
   - æ— éœ€å…³é—­æˆ–é‡å¯ App
   - ä¸‹æ¬¡æ‰“å¼€ App è‡ªåŠ¨ä½¿ç”¨ä¸Šæ¬¡é€‰æ‹©çš„è¯­è¨€

## ğŸ”§ æŠ€æœ¯å®ç°

### 1. LanguageManagerï¼ˆè¯­è¨€ç®¡ç†å™¨ï¼‰

**æ–‡ä»¶ä½ç½®**: `Earthlord/Managers/LanguageManager.swift`

**ä¸»è¦åŠŸèƒ½**:
- å•ä¾‹æ¨¡å¼ç®¡ç†å…¨å±€è¯­è¨€è®¾ç½®
- ä½¿ç”¨ `@Published` å±æ€§å‘å¸ƒè¯­è¨€å˜åŒ–
- UserDefaults æŒä¹…åŒ–å­˜å‚¨
- Bundle åˆ‡æ¢å®ç°å®æ—¶è¯­è¨€åˆ‡æ¢
- NotificationCenter é€šçŸ¥ UI åˆ·æ–°

**æ ¸å¿ƒä»£ç **:
```swift
@MainActor
class LanguageManager: ObservableObject {
    static let shared = LanguageManager()

    @Published var currentLanguage: AppLanguage
    @Published private(set) var bundle: Bundle

    func switchLanguage(to language: AppLanguage) {
        currentLanguage = language
        // è‡ªåŠ¨è§¦å‘ didSetï¼Œæ›´æ–° Bundle å’Œé€šçŸ¥ UI
    }
}
```

**ä½¿ç”¨æ–¹æ³•**:
```swift
// è·å–å®ä¾‹
@StateObject private var languageManager = LanguageManager.shared

// åˆ‡æ¢è¯­è¨€
languageManager.switchLanguage(to: .chinese)

// è·å–æœ¬åœ°åŒ–å­—ç¬¦ä¸²
let text = languageManager.localizedString("è®¾ç½®")
```

### 2. String æ‰©å±•ï¼ˆä¾¿æ·æœ¬åœ°åŒ–ï¼‰

**ä½¿ç”¨æ–¹æ³•**:
```swift
// ç®€å•æœ¬åœ°åŒ–
Text("è®¾ç½®".localized)

// å¸¦å‚æ•°çš„æœ¬åœ°åŒ–
Text("éªŒè¯ç å·²å‘é€è‡³ %@".localized(with: email))
```

### 3. SettingsViewï¼ˆè®¾ç½®é¡µé¢ï¼‰

**æ–‡ä»¶ä½ç½®**: `Earthlord/Views/Settings/SettingsView.swift`

**ä¸»è¦ç»„ä»¶**:
- `SettingsSectionCard` - è®¾ç½®åŒºå—å¡ç‰‡
- `LanguageOptionRow` - è¯­è¨€é€‰é¡¹è¡Œ
- å®æ—¶å“åº”è¯­è¨€åˆ‡æ¢

**ç‰¹æ€§**:
- æ¸…æ™°çš„ UI å¸ƒå±€
- æ¯ä¸ªè¯­è¨€é€‰é¡¹éƒ½æœ‰å¯¹åº”å›¾æ ‡
- å½“å‰é€‰æ‹©çš„è¯­è¨€æ˜¾ç¤ºå‹¾é€‰æ ‡è®°
- ç‚¹å‡»å³æ—¶åˆ‡æ¢ï¼Œæ— ç¡®è®¤å¯¹è¯æ¡†

### 4. ProfileTabView é›†æˆ

**ä¿®æ”¹å†…å®¹**:
- æ·»åŠ  `@StateObject private var languageManager`
- æ·»åŠ  `@State private var showSettings` æ§åˆ¶è®¾ç½®é¡µé¢æ˜¾ç¤º
- æ·»åŠ  `@State private var refreshID` å¼ºåˆ¶åˆ·æ–° UI
- ç›‘å¬ `.languageDidChange` é€šçŸ¥
- "è®¾ç½®"èœå•é¡¹æ‰“å¼€ SettingsView

**æ ¸å¿ƒä»£ç **:
```swift
.id(refreshID)
.onReceive(NotificationCenter.default.publisher(for: .languageDidChange)) { _ in
    print("ğŸŒ æ”¶åˆ°è¯­è¨€åˆ‡æ¢é€šçŸ¥ï¼Œåˆ·æ–°ç•Œé¢")
    refreshID = UUID()
}
```

## ğŸ“Š æœ¬åœ°åŒ–å­—ç¬¦ä¸²

### æ–°å¢çš„æœ¬åœ°åŒ–æ¡ç›®

| ä¸­æ–‡ | English |
|------|---------|
| è®¾ç½® | Settings |
| è¯­è¨€è®¾ç½® | Language Settings |
| åˆ‡æ¢è¯­è¨€åå°†ç«‹å³ç”Ÿæ•ˆ | Language changes will take effect immediately |
| å®Œæˆ | Done |
| è·Ÿéšç³»ç»Ÿ / Follow System | Follow System |
| ç®€ä½“ä¸­æ–‡ | Simplified Chinese |

### ç°æœ‰æ”¯æŒçš„æ¡ç›®

å·²æ”¯æŒ **56 ä¸ª**æœ¬åœ°åŒ–å­—ç¬¦ä¸²ï¼Œè¦†ç›–ï¼š
- âœ… è®¤è¯æµç¨‹ï¼ˆç™»å½•ã€æ³¨å†Œã€å¯†ç ï¼‰
- âœ… éªŒè¯ç æµç¨‹
- âœ… è´¦æˆ·ç®¡ç†ï¼ˆä¸ªäººèµ„æ–™ã€é€€å‡ºã€åˆ é™¤ï¼‰
- âœ… æ¸¸æˆç•Œé¢ï¼ˆåœ°å›¾ã€é¢†åœ°ã€å¯¼èˆªï¼‰
- âœ… é€šç”¨ç»„ä»¶ï¼ˆæŒ‰é’®ã€è¡¨å•ã€æç¤ºï¼‰
- âœ… è®¾ç½®é¡µé¢

## ğŸ”„ å·¥ä½œåŸç†

### è¯­è¨€åˆ‡æ¢æµç¨‹

```
ç”¨æˆ·ç‚¹å‡»è¯­è¨€é€‰é¡¹
    â†“
LanguageManager.switchLanguage()
    â†“
æ›´æ–° currentLanguageï¼ˆè§¦å‘ didSetï¼‰
    â†“
ä¿å­˜åˆ° UserDefaults
    â†“
æ›´æ–° Bundleï¼ˆåŠ è½½å¯¹åº”è¯­è¨€åŒ…ï¼‰
    â†“
å‘é€ .languageDidChange é€šçŸ¥
    â†“
UI ç»„ä»¶æ¥æ”¶é€šçŸ¥
    â†“
åˆ·æ–°ç•Œé¢ï¼ˆé€šè¿‡ refreshIDï¼‰
    â†“
æ˜¾ç¤ºæ–°è¯­è¨€æ–‡æœ¬
```

### æœ¬åœ°åŒ–å­—ç¬¦ä¸²è·å–æµç¨‹

```
Text("è®¾ç½®".localized)
    â†“
String.localized æ‰©å±•
    â†“
LanguageManager.shared.localizedString("è®¾ç½®")
    â†“
bundle.localizedString(forKey: "è®¾ç½®", ...)
    â†“
ä»å½“å‰ Bundle è·å–å¯¹åº”è¯­è¨€çš„å­—ç¬¦ä¸²
    â†“
è¿”å›æœ¬åœ°åŒ–æ–‡æœ¬ï¼ˆ"è®¾ç½®" æˆ– "Settings"ï¼‰
```

## ğŸ¨ UI è®¾è®¡

### è®¾ç½®é¡µé¢å¸ƒå±€
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      è®¾ç½®     [å®Œæˆ]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         â”‚
â”‚  è¯­è¨€è®¾ç½®               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ”§ è·Ÿéšç³»ç»Ÿ/...  â—‹â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ ğŸ“ ç®€ä½“ä¸­æ–‡      â—‹â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ ğŸ”¤ English       â—â”‚ â”‚ â† å½“å‰é€‰æ‹©
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                         â”‚
â”‚  åˆ‡æ¢è¯­è¨€åå°†ç«‹å³ç”Ÿæ•ˆ    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è§†è§‰ç‰¹æ€§
- **æ·±è‰²ä¸»é¢˜** - ç¬¦åˆæ¸¸æˆé£æ ¼
- **æ©™è‰²å¼ºè°ƒ** - é€‰ä¸­é¡¹å’ŒæŒ‰é’®ä½¿ç”¨ä¸»é¢˜è‰²
- **æ¸…æ™°å›¾æ ‡** - æ¯ä¸ªé€‰é¡¹éƒ½æœ‰å¯¹åº”çš„ç³»ç»Ÿå›¾æ ‡
- **å‹¾é€‰æ ‡è®°** - å½“å‰é€‰æ‹©æ˜¾ç¤ºå¡«å……çš„åœ†å½¢å‹¾é€‰
- **æµç•…åŠ¨ç”»** - Sheet å¼¹å‡ºå’Œæ¶ˆå¤±æœ‰å¹³æ»‘è¿‡æ¸¡

## ğŸ“ å¼€å‘è€…æŒ‡å—

### åœ¨æ–°é¡µé¢ä¸­æ·»åŠ è¯­è¨€åˆ‡æ¢æ”¯æŒ

1. **æ·»åŠ  LanguageManager**:
```swift
@StateObject private var languageManager = LanguageManager.shared
```

2. **æ·»åŠ åˆ·æ–° ID**:
```swift
@State private var refreshID = UUID()
```

3. **ç›‘å¬è¯­è¨€åˆ‡æ¢é€šçŸ¥**:
```swift
.id(refreshID)
.onReceive(NotificationCenter.default.publisher(for: .languageDidChange)) { _ in
    refreshID = UUID()
}
```

4. **ä½¿ç”¨æœ¬åœ°åŒ–å­—ç¬¦ä¸²**:
```swift
Text("ä½ çš„æ–‡æœ¬".localized)
```

### æ·»åŠ æ–°çš„æœ¬åœ°åŒ–å­—ç¬¦ä¸²

1. **æ‰“å¼€ Localizable.xcstrings**
2. **æ·»åŠ æ–°æ¡ç›®**:
```json
"ä½ çš„ä¸­æ–‡æ–‡æœ¬" : {
  "localizations" : {
    "en" : {
      "stringUnit" : {
        "state" : "translated",
        "value" : "Your English Text"
      }
    }
  }
}
```
3. **åœ¨ä»£ç ä¸­ä½¿ç”¨**:
```swift
Text("ä½ çš„ä¸­æ–‡æ–‡æœ¬".localized)
```

### è°ƒè¯•æ—¥å¿—

è¯­è¨€åˆ‡æ¢æ—¶ä¼šè¾“å‡ºè¯¦ç»†æ—¥å¿—ï¼š
```
ğŸŒ ç”¨æˆ·é€‰æ‹©è¯­è¨€: English
ğŸŒ è¯­è¨€åˆ‡æ¢: ç®€ä½“ä¸­æ–‡ â†’ English
âœ… è¯­è¨€è®¾ç½®å·²ä¿å­˜: en
ğŸŒ ä½¿ç”¨æŒ‡å®šè¯­è¨€: en
âœ… æˆåŠŸåŠ è½½è¯­è¨€åŒ…: en
ğŸ“¢ å·²å‘é€è¯­è¨€åˆ‡æ¢é€šçŸ¥
ğŸŒ ProfileTabView æ”¶åˆ°è¯­è¨€åˆ‡æ¢é€šçŸ¥ï¼Œåˆ·æ–°ç•Œé¢
```

## âœ… æµ‹è¯•æ¸…å•

### åŸºç¡€åŠŸèƒ½æµ‹è¯•
- [x] ç‚¹å‡»"è®¾ç½®"èœå•é¡¹æ‰“å¼€è®¾ç½®é¡µé¢
- [x] æ˜¾ç¤ºä¸‰ä¸ªè¯­è¨€é€‰é¡¹
- [x] å½“å‰è¯­è¨€æ˜¾ç¤ºå‹¾é€‰æ ‡è®°
- [x] ç‚¹å‡»å…¶ä»–è¯­è¨€ç«‹å³åˆ‡æ¢
- [x] åˆ‡æ¢åæ‰€æœ‰æ–‡æœ¬æ›´æ–°
- [x] å…³é—­è®¾ç½®é¡µé¢åä¿æŒæ–°è¯­è¨€
- [x] é‡å¯ App åä¿æŒä¸Šæ¬¡é€‰æ‹©çš„è¯­è¨€

### å„è¯­è¨€æµ‹è¯•
- [x] è·Ÿéšç³»ç»Ÿ - æ ¹æ®ç³»ç»Ÿè¯­è¨€æ˜¾ç¤º
- [x] ç®€ä½“ä¸­æ–‡ - æ‰€æœ‰æ–‡æœ¬æ˜¾ç¤ºä¸­æ–‡
- [x] English - æ‰€æœ‰æ–‡æœ¬æ˜¾ç¤ºè‹±æ–‡

### è¾¹ç•Œæƒ…å†µæµ‹è¯•
- [x] å¿«é€Ÿè¿ç»­åˆ‡æ¢è¯­è¨€
- [x] åˆ‡æ¢è¯­è¨€åç«‹å³é€€å‡ºç™»å½•
- [x] åˆ‡æ¢è¯­è¨€ååˆ é™¤è´¦æˆ·
- [x] ä¸åŒé¡µé¢é—´åˆ‡æ¢æ—¶ä¿æŒè¯­è¨€

## ğŸ¯ å·²å®ŒæˆåŠŸèƒ½

- âœ… LanguageManager å•ä¾‹ç®¡ç†å™¨
- âœ… ä¸‰ç§è¯­è¨€é€‰é¡¹æ”¯æŒ
- âœ… ç«‹å³ç”Ÿæ•ˆæœºåˆ¶
- âœ… æŒä¹…åŒ–å­˜å‚¨
- âœ… è®¾ç½®é¡µé¢ UI
- âœ… ProfileTabView é›†æˆ
- âœ… 56 ä¸ªæœ¬åœ°åŒ–å­—ç¬¦ä¸²
- âœ… é€šçŸ¥æœºåˆ¶å®ç° UI åˆ·æ–°
- âœ… æ„å»ºæˆåŠŸ

## ğŸ“„ ç›¸å…³æ–‡ä»¶

### æ–°å¢æ–‡ä»¶
- `Earthlord/Managers/LanguageManager.swift` - è¯­è¨€ç®¡ç†å™¨
- `Earthlord/Views/Settings/SettingsView.swift` - è®¾ç½®é¡µé¢

### ä¿®æ”¹æ–‡ä»¶
- `Earthlord/Views/Tabs/ProfileTabView.swift` - æ·»åŠ è®¾ç½®å…¥å£
- `Localizable.xcstrings` - æ·»åŠ æ–°çš„æœ¬åœ°åŒ–å­—ç¬¦ä¸²

## ğŸš€ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1: åœ¨æ–°è§†å›¾ä¸­ä½¿ç”¨æœ¬åœ°åŒ–

```swift
struct MyNewView: View {
    @StateObject private var languageManager = LanguageManager.shared
    @State private var refreshID = UUID()

    var body: some View {
        VStack {
            Text("æ¬¢è¿".localized)
            Text("ä½ å¥½ï¼Œ%@".localized(with: "ä¸–ç•Œ"))
        }
        .id(refreshID)
        .onReceive(NotificationCenter.default.publisher(for: .languageDidChange)) { _ in
            refreshID = UUID()
        }
    }
}
```

### ç¤ºä¾‹ 2: æ‰‹åŠ¨åˆ‡æ¢è¯­è¨€

```swift
// åœ¨ä»»ä½•åœ°æ–¹åˆ‡æ¢è¯­è¨€
LanguageManager.shared.switchLanguage(to: .english)
```

### ç¤ºä¾‹ 3: è·å–å½“å‰è¯­è¨€

```swift
let currentLanguage = LanguageManager.shared.currentLanguage
print("å½“å‰è¯­è¨€: \(currentLanguage.displayName)")
```

## ğŸ‰ æ€»ç»“

Earthlord ç°åœ¨æ‹¥æœ‰å®Œæ•´çš„ App å†…è¯­è¨€åˆ‡æ¢åŠŸèƒ½ï¼

**æ ¸å¿ƒä¼˜åŠ¿**:
- ğŸš€ **ç«‹å³ç”Ÿæ•ˆ** - æ— éœ€é‡å¯
- ğŸ’¾ **æŒä¹…åŒ–** - ä¿å­˜ç”¨æˆ·é€‰æ‹©
- ğŸ¨ **ä¼˜é›… UI** - ç¬¦åˆæ¸¸æˆä¸»é¢˜
- ğŸ“ **å®Œæ•´æ”¯æŒ** - 56 ä¸ªæœ¬åœ°åŒ–å­—ç¬¦ä¸²
- ğŸ”§ **æ˜“äºæ‰©å±•** - ç®€å•çš„å¼€å‘è€… API

ç”¨æˆ·ç°åœ¨å¯ä»¥è‡ªç”±é€‰æ‹© App è¯­è¨€ï¼Œä¸å†å—ç³»ç»Ÿè¯­è¨€é™åˆ¶ï¼ğŸŒâœ¨
